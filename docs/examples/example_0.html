
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>A simple band structure calculation &#8212; k Quant 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation" href="../modules.html" />
    <link rel="prev" title="Tutorials" href="../example.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="a-simple-band-structure-calculation">
<h1>A simple band structure calculation<a class="headerlink" href="#a-simple-band-structure-calculation" title="Permalink to this heading">Â¶</a></h1>
<p>For this example, let us first define a Hamiltonian in momentum space which we will
use to compute the band structure. In this case, we choose as prototype a model for <span class="math notranslate nohighlight">\(p_z\)</span> electrons
in graphene within the nearest neighbor approximation with lattice vectors
defined in the lat_vec variable</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">dot</span><span class="p">,</span> <span class="n">conj</span><span class="p">,</span> <span class="nb">min</span><span class="p">,</span><span class="nb">max</span><span class="p">,</span> <span class="nb">abs</span>
<span class="n">lat_vec</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span> <span class="p">],</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span> <span class="p">]</span> <span class="p">]</span>
<span class="k">def</span> <span class="nf">hamiltonian</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="n">a_0</span><span class="p">,</span> <span class="n">a_1</span><span class="p">,</span> <span class="n">a2</span>  <span class="o">=</span> <span class="n">lat_vec</span><span class="p">;</span>
    <span class="n">hop</span> <span class="o">=</span> <span class="mf">2.8</span><span class="p">;</span>
    <span class="n">f_k</span> <span class="o">=</span> <span class="n">hop</span><span class="o">*</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">a_0</span><span class="p">))</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">dot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">a_1</span><span class="p">))</span> <span class="p">);</span>
    <span class="k">return</span> <span class="p">[</span> <span class="p">[</span> <span class="mi">0</span>        <span class="p">,</span> <span class="n">f_k</span><span class="p">],</span>
            <span class="p">[</span> <span class="n">conj</span><span class="p">(</span><span class="n">f_k</span><span class="p">),</span>  <span class="mi">0</span> <span class="p">]</span>
            <span class="p">];</span>
</pre></div>
</div>
<p>Then, we need to define the bandpath using as a list of tuples, consisting in
the kpoint label, its position in the normalized Brilluoin zone, and the numbers
of point between that point and the next bandpath point. Once define, this variable
is pass to the bandstructure class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">k_quant</span> <span class="k">as</span> <span class="nn">k</span>

<span class="c1">#The band class requires lattice vectors and the hamiltonian function</span>
<span class="n">graphene</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">bandstructure</span><span class="p">(</span><span class="n">lat_vec</span><span class="p">,</span> <span class="n">hamiltonian</span> <span class="p">);</span>

<span class="c1">#To plot a desire band-path you pass it to the class as a list of tuples</span>
<span class="n">npts</span><span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="n">bandpath</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="s2">&quot;K&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">111</span> <span class="p">),</span> <span class="p">(</span><span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">35</span><span class="p">)</span> <span class="p">,</span> <span class="p">(</span><span class="s2">&quot;M&quot;</span><span class="p">,(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">55</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;K&#39;&quot;</span><span class="p">,(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span> <span class="p">];</span>
<span class="n">graphene</span><span class="o">.</span><span class="n">set_bandpath</span><span class="p">(</span><span class="n">bandpath</span><span class="p">);</span>

<span class="c1">#The computing the band structure is as simmple as</span>
<span class="n">sigma_x</span><span class="p">,</span><span class="n">sigma_y</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],[</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span> <span class="p">];</span>
<span class="n">bandstructure</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">compute_bands</span><span class="p">(</span> <span class="n">proj_ops</span><span class="o">=</span><span class="p">[</span> <span class="n">sigma_x</span><span class="p">,</span><span class="n">sigma_y</span><span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<p>Finally we plot the result</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">();</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">();</span>
<span class="n">xaxis</span> <span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">Xaxis</span><span class="p">();</span>
<span class="k">for</span> <span class="n">proj_band</span> <span class="ow">in</span> <span class="n">bandstructure</span><span class="p">:</span>
    <span class="n">band</span><span class="p">,</span><span class="n">sigma_x</span><span class="p">,</span><span class="n">sigma_y</span> <span class="o">=</span> <span class="n">proj_band</span><span class="p">;</span>
    <span class="n">z</span>   <span class="o">=</span> <span class="n">sigma_x</span><span class="p">;</span>
    <span class="n">s</span>   <span class="o">=</span>  <span class="mi">20</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span><span class="n">band</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">);</span>
    <span class="n">im</span>  <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xaxis</span><span class="p">,</span><span class="n">band</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>

<span class="n">xlabels</span><span class="o">=</span> <span class="n">graphene</span><span class="o">.</span><span class="n">XLabels</span><span class="p">();</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xlabels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">xlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;proj_band_sigma_x.pdf&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">k Quant</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../example.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">A simple band structure calculation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Documentation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../example.html">Tutorials</a><ul>
      <li>Previous: <a href="../example.html" title="previous chapter">Tutorials</a></li>
      <li>Next: <a href="../modules.html" title="next chapter">Documentation</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Jose H. Garcia.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/examples/example_0.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>